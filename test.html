<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GhostHub - Test Page</title>
</head>
<body>
  <h1>GhostHub Implementation Test</h1>
  <p>This page is for testing the GhostHub extension implementation.</p>
  
  <h2>Test Instructions:</h2>
  <ol>
    <li>Load the extension in Chrome (chrome://extensions)</li>
    <li>Enable "Developer mode"</li>
    <li>Click "Load unpacked" and select the ghosthub directory</li>
    <li>Open the browser console (F12)</li>
    <li>Click the extension icon to open the popup</li>
    <li>Check the API availability status</li>
  </ol>

  <h2>Manual Testing:</h2>
  <div id="test-area">
    <h3>Test Message Classification</h3>
    <textarea id="test-message" rows="4" cols="50" placeholder="Enter a test message...">The app crashes when I click the submit button</textarea>
    <br>
    <button id="classify-btn">Classify Message</button>
    <div id="classification-result"></div>

    <h3>Test Thread Summarization</h3>
    <button id="summarize-btn">Summarize Test Thread</button>
    <div id="summary-result"></div>

    <h3>View Storage</h3>
    <button id="view-classifications">View Classifications</button>
    <button id="view-summaries">View Summaries</button>
    <button id="view-issues">View Issues</button>
    <div id="storage-result"></div>
  </div>

  <script>
    // Note: This script is for demonstration purposes
    // In production, these functions would be called through the content script
    
    document.getElementById('classify-btn')?.addEventListener('click', async () => {
      const message = document.getElementById('test-message').value;
      const result = document.getElementById('classification-result');
      
      try {
        const response = await chrome.runtime.sendMessage({
          type: 'CLASSIFY_MESSAGE',
          data: {
            text: message,
            platform: 'test',
            author: 'test_user',
            timestamp: Date.now()
          }
        });
        
        result.innerHTML = `<pre>${JSON.stringify(response, null, 2)}</pre>`;
      } catch (error) {
        result.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
      }
    });

    document.getElementById('summarize-btn')?.addEventListener('click', async () => {
      const result = document.getElementById('summary-result');
      
      const testThread = {
        threadId: 'test_thread_1',
        platform: 'test',
        messages: [
          { author: 'alice', text: 'The app crashes when I submit the form', timestamp: Date.now() },
          { author: 'bob', text: 'I can reproduce this. It happens on the payment page', timestamp: Date.now() },
          { author: 'charlie', text: 'Same issue here. Console shows a null pointer exception', timestamp: Date.now() }
        ]
      };
      
      try {
        const response = await chrome.runtime.sendMessage({
          type: 'PROCESS_THREAD',
          data: testThread
        });
        
        result.innerHTML = `<pre>${JSON.stringify(response, null, 2)}</pre>`;
      } catch (error) {
        result.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
      }
    });

    document.getElementById('view-classifications')?.addEventListener('click', async () => {
      const result = document.getElementById('storage-result');
      
      try {
        const response = await chrome.runtime.sendMessage({
          type: 'GET_CLASSIFICATIONS',
          filters: {}
        });
        
        result.innerHTML = `<h4>Classifications:</h4><pre>${JSON.stringify(response.classifications, null, 2)}</pre>`;
      } catch (error) {
        result.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
      }
    });

    document.getElementById('view-summaries')?.addEventListener('click', async () => {
      const result = document.getElementById('storage-result');
      
      try {
        const response = await chrome.runtime.sendMessage({
          type: 'GET_SUMMARIES',
          filters: {}
        });
        
        result.innerHTML = `<h4>Summaries:</h4><pre>${JSON.stringify(response.summaries, null, 2)}</pre>`;
      } catch (error) {
        result.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
      }
    });

    document.getElementById('view-issues')?.addEventListener('click', async () => {
      const result = document.getElementById('storage-result');
      
      try {
        const response = await chrome.runtime.sendMessage({
          type: 'GET_ISSUES',
          filters: {}
        });
        
        result.innerHTML = `<h4>Issues:</h4><pre>${JSON.stringify(response.issues, null, 2)}</pre>`;
      } catch (error) {
        result.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
      }
    });

    console.log('GhostHub test page loaded');
  </script>

  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
    }

    h1 {
      color: #667eea;
    }

    #test-area {
      background: #f5f5f5;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
    }

    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      margin: 10px 5px 10px 0;
    }

    button:hover {
      background: #5568d3;
    }

    textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      margin: 10px 0;
    }

    pre {
      background: white;
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
      border: 1px solid #ddd;
    }

    #classification-result,
    #summary-result,
    #storage-result {
      margin-top: 15px;
    }
  </style>
</body>
</html>
